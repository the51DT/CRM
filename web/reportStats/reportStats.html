<!DOCTYPE html>
<html lang="en">
  <div data-include-path="/fragments/head.html"></div>
  <body>
    <div id="root">
      <!-- header include -->
      <header id="header">
        <div data-include-path="/fragments/header.html"></div>
      </header>
      <!-- container -->
      <div id="container">
        <!-- lnb include -->
        <nav id="lnb">
          <div data-include-path="/fragments/lnb.html"></div>
        </nav>
        <!-- contents -->
        <div id="contents">
          <div class="contents__inner">
            <h2>현황 레포트</h2>

            <!-- 2025-05 신규 수정/추가 -->
            <section class="row">
              <div class="form-box">
                <table class="form-table">
                  <colgroup>
                    <col style="width: 140px" />
                    <col style="width: 30%" />
                    <col style="width: 140px" />
                    <col />
                  </colgroup>
                  <tbody>
                    <tr>
                      <th>조회 조직</th>
                      <td colspan="3">
                        <select class="w300 uiscroll" aria-label="조회 조직 열기">
                          <option data-value="">조회 조직을 선택해 주세요</option>
                          <option data-value="">-</option>
                        </select>
                      </td>
                    </tr>
                    <tr>
                      <th>조회 기간</th>
                      <td>
                        <div class="date-picker-group" id="reportStats">
                          <input type="text" class="formatSelector" value="month" hidden />
                          <div class="start-date1 input-group datepicker w-auto" data-target-input="nearest">
                            <input
                              id="startDt"
                              type="text"
                              class="form-control datetimepicker-input"
                              data-target=".start-date1"
                              placeholder="시작일"
                              readonly
                              min-view="month"
                            />
                            <div class="input-group-append" data-target=".start-date1" data-toggle="datetimepicker">
                              <button class="input-group-text">
                                <img src="/assets/images/common/icon_datepicker.png" alt="달력 이미지" />
                              </button>
                            </div>
                          </div>
                        </div>
                      </td>
                    </tr>
                    <tr>
                      <th>고객 Care 유형</th>
                      <td>
                        <select class="w300 uiscroll" aria-label="고객 Care 유형 열기">
                          <option value="">고객 Care 유형을 선택해 주세요</option>
                          <option value="">전체</option>
                          <option value="">해지 고위험</option>
                          <option value="">잠재 불만</option>
                        </select>
                      </td>
                      <th>발생 지표</th>
                      <td>
                        <select class="w300 uiscroll" aria-label="발생 지표 열기">
                          <option value="">발생지표를 선택해 주세요</option>
                          <option value="">전체</option>
                          <option value="">30일 내 재 장애</option>
                        </select>
                      </td>
                    </tr>
                  </tbody>
                </table>
                <div class="flex">
                  <button type="button" class="btn btn-ico btn-reset">초기화</button>
                  <button type="button" class="btn btn-ico btn-search">검색</button>
                </div>
              </div>
            </section>

            <section class="row">
              <div class="d-flex">
                <h3>현장지원 팀별 실적</h3>
                <p class="sub-text-info">마감 기준 2025-03-07<span>(유선 CEM 조회율은 전체 발생건 기준, 결과 등록 건은 마감일 기준)</span></p>
              </div>
              <table class="dataTable row-border hover static-data summary-table">
                <thead>
                  <tr>
                    <th rowspan="2">현장지원팀</th>
                    <th colspan="3">유선 CEM</th>
                    <th rowspan="2">미처리</th>
                    <th colspan="6">당월</th>
                    <th colspan="6">전월</th>
                  </tr>
                  <tr>
                    <th class="even-header">발생건</th>
                    <th class="even-header">조회건</th>
                    <th class="even-header">조회율</th>
                    <th class="even-header">마감 대상</th>
                    <th class="even-header">결과 등록</th>
                    <th class="even-header">미등록</th>
                    <th class="even-header">등록율</th>
                    <th class="even-header">방문건</th>
                    <th class="even-header">방문율</th>
                    <th class="even-header">마감 대상</th>
                    <th class="even-header">결과 등록</th>
                    <th class="even-header">미등록</th>
                    <th class="even-header">등록율</th>
                    <th class="even-header">방문건</th>
                    <th class="even-header">방문율</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="total-row">
                    <td>전체 계</td>
                    <td>35,852</td>
                    <td>55,852</td>
                    <td>88.5%</td>
                    <td>66,2256</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                  </tr>
                  <tr>
                    <td>동부홈서비스고객만족실행팀</td>
                    <td>35,852</td>
                    <td>55,852</td>
                    <td>88.5%</td>
                    <td>66,2256</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                  </tr>
                  <tr>
                    <td>강북홈서비스고객만족실행팀</td>
                    <td>35,852</td>
                    <td>55,852</td>
                    <td>88.5%</td>
                    <td>66,2256</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                  </tr>
                  <tr class="total-row">
                    <td>홈서비스 계</td>
                    <td>35,852</td>
                    <td>55,852</td>
                    <td>88.5%</td>
                    <td>66,2256</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                  </tr>
                  <tr>
                    <td>강남서비스팀</td>
                    <td>35,852</td>
                    <td>55,852</td>
                    <td>88.5%</td>
                    <td>66,2256</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                  </tr>
                </tbody>
              </table>
            </section>

            <section class="row">
              <!-- <h3>협력사별 실적</h3> -->
              <table class="dataTable row-border hover static-data summary-table" id="pubTable1">
                <thead>
                  <tr>
                    <th rowspan="2">소속</th>
                    <th rowspan="2">대리점코드</th>
                    <th rowspan="2">서비스센터</th>
                    <th colspan="3">유선 CEM</th>
                    <th rowspan="2">미처리</th>
                    <th colspan="6">당월</th>
                    <th colspan="6">전월</th>
                  </tr>
                  <tr>
                    <th class="even-header">발생건</th>
                    <th class="even-header">조회건</th>
                    <th class="even-header">조회율</th>
                    <th class="even-header">마감 대상</th>
                    <th class="even-header">결과 등록</th>
                    <th class="even-header">미등록</th>
                    <th class="even-header">등록율</th>
                    <th class="even-header">방문건</th>
                    <th class="even-header">방문율</th>
                    <th class="even-header">마감 대상</th>
                    <th class="even-header">결과 등록</th>
                    <th class="even-header">미등록</th>
                    <th class="even-header">등록율</th>
                    <th class="even-header">방문건</th>
                    <th class="even-header">방문율</th>
                  </tr>
                </thead>
                <tbody>
                  <tr class="total-row">
                    <td>전체 계</td>
                    <td>633426</td>
                    <td>안산단원_개통AS센터_이앤디비즈</td>
                    <td>35,852</td>
                    <td>55,852</td>
                    <td>88.5%</td>
                    <td>66,2256</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                  </tr>
                  <tr>
                    <td>동부홈서비스고객만족실행팀</td>
                    <td>633426</td>
                    <td>안산단원_개통AS센터_이앤디비즈</td>
                    <td>35,852</td>
                    <td>55,852</td>
                    <td>88.5%</td>
                    <td>66,2256</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                    <td>95,874</td>
                    <td>35,874</td>
                    <td>5,874</td>
                    <td>88.5%</td>
                    <td>5,874</td>
                    <td>88%</td>
                  </tr>
                </tbody>
              </table>
            </section>
            <!-- //2025-05 신규 수정/추가 -->
          </div>
        </div>
        <!-- // contents -->
      </div>
      <!-- // container -->
    </div>
  </body>
  <script src="/assets/js/plugins/jquery-3.7.1.min.js"></script>
  <script src="/assets/js/plugins/bootstrap.bundle.min.js"></script>
  <script src="/assets/js/plugins/moment-with-locales.min.js"></script>
  <script src="/assets/js/plugins/tempusdominus-bootstrap-4.js"></script>
  <script src="/assets/js/plugins/swiper-bundle.min.js"></script>
  <script src="/assets/js/plugins/dataTables.min.js"></script>
  <script src="/assets/js/plugins/jstree.min.js"></script>
  <script src="/assets/js/common.js"></script>
  <script src="/js/common2.js"></script>
  <script src="/js/chart.umd.js"></script>
  <script>
    window.addEventListener("load", function () {
      var allElements = document.getElementsByTagName("*");
      Array.prototype.forEach.call(allElements, function (el) {
        var includePath = el.dataset.includePath;
        if (includePath) {
          var HTTP = new XMLHttpRequest();
          HTTP.onreadystatechange = function () {
            if (this.readyState == 4 && this.status == 200) {
              el.outerHTML = this.responseText;
            }
          };
          HTTP.open("GET", includePath, true);
          HTTP.send();
        }
      });

      // s : 퍼블 화면 테스트 스크립트
      $("#pubTable1").DataTable({
        ...dataTableOptions,
        paging: false,
        scrollX: false,
        buttons: [
          {
            extend: "",
            text: "다운로드",
            className: "btn btn-ico btn-download",
            attr: {
              id: "downloadBtn",
            },
            action: function () {
              console.log("다운로드");
            },
          },
        ],
        initComplete: function () {
          // dt-button 버튼 초기화
          const dtButtons = document.querySelectorAll(".dt-container .dt-buttons .btn");
          dtButtons.forEach((button) => {
            button.classList.remove("dt-button");
          });

          // 셀렉트 로딩
          UI.isSelectCustom();

          // 추가 버튼 그룹
          const titleHTML = `<h3>협력사별 실적</h3>`;

          // dt-container
          const dtContainer = document.querySelector(".dt-container .dt-buttons");
          dtContainer.insertAdjacentHTML("beforebegin", titleHTML);
        },
      });

      // $(".start-date1").datetimepicker({
      //   format: "YYYY-MM",
      //   viewMode: "months",
      //   defaultDate: moment(),
      //   locale: "ko",
      // });
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, "0");
      const formatted = `${yyyy}-${mm}`;
      document.getElementById("startDt").value = formatted;

      const lnbActiveTest = () => {
        const lnbActive = lnb.querySelector(".depth1-link.stats");
        if (lnbActive) {
          const depth2 = lnbActive.nextElementSibling;
          if (depth2 && depth2.classList.contains("depth2")) {
            depth2.style.display = "block";
            const secondLi = depth2.querySelectorAll("li > a")[3];
            if (secondLi) {
              secondLi.classList.add("active");
            }
          }
        }
        if (lnbActive) {
          lnbActive.classList.add("active");
        }
      };
      setTimeout(() => {
        lnbActiveTest();
      }, 500);
      // e : 퍼블 화면 테스트 스크립트

    });
  </script>
</html>
